<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<title>PresentationBridge Client</title>
		<link rel="stylesheet" href="node_modules/bootstrap/dist/css/bootstrap.min.css">
		<link rel="stylesheet" href="index.css">
		<script>window.$ = window.jQuery = require('./node_modules/jquery/dist/jquery.min.js');</script>
		<script src='./node_modules/jquery/dist/jquery.min.js'></script>
		<script src='./node_modules/bootstrap/dist/js/bootstrap.bundle.js'></script>
		<script src="./static/mask.ip-input.js"></script>
		<script>
			
			const ipc = require('electron').ipcRenderer;
			const remote = require('electron').remote;
			const { shell } = require('electron')
			
			const config = require('./config');

			const marked = require("marked");
			const helpFile = './help.md';

			const fs = require('fs')

			var propresenter_status = 'disconnected';
			var mdns_propresenter_hosts = [];
			var mdns_midirelay_hosts = [];

			var presentationbridge_status = 'disconnected';

			var plugin_midirelay_enabled = true;
			var plugin_vista_enabled = true;
			var plugin_http_enabled = true;
			var plugin_companion_enabled = true;

			//IPCs    
			ipc.on('propresenter_status', function (event, status) {
				let displayText = '';
				propresenter_status = status;
				switch(propresenter_status) {
					case 'force_disconnected':
						displayText = 'Connect';
						$('#divProPresenterStatus').text('Disconnected.');
						propresenter_disablefields(false);
						$('#btnProPresenterConnect').removeClass('btn-primary btn-danger btn-warning');
						$('#btnProPresenterConnect').addClass('btn-primary');
						break;
					case 'connecting':
						displayText = 'Connecting...';
						propresenter_disablefields(true);
						$('#btnProPresenterConnect').removeClass('btn-primary btn-warning btn-danger');
						$('#btnProPresenterConnect').addClass('btn-warning');
						break;
					case 'reconnecting':
						displayText = 'Reconnecting...';
						propresenter_disablefields(true);
						$('#btnProPresenterConnect').removeClass('btn-primary btn-warning btn-danger');
						$('#btnProPresenterConnect').addClass('btn-warning');
						break;
					case 'open':
						displayText = 'Open, Not Authenticated.';
						$('#btnProPresenterConnect').removeClass('btn-primary btn-warning btn-danger');
						$('#btnProPresenterConnect').addClass('btn-warning');
						break;
					case 'authenticated':
						displayText = 'Disconnect';
						propresenter_disablefields(true);
						$('#btnProPresenterConnect').removeClass('btn-primary btn-warning btn-danger');
						$('#btnProPresenterConnect').addClass('btn-danger');
						break;
					case 'badpassword':
						displayText = 'Connect';
						$('#divProPresenterStatus').text('Incorrect Password.');
						propresenter_disablefields(false);
						$('#btnProPresenterConnect').removeClass('btn-primary btn-warning btn-danger');
						$('#btnProPresenterConnect').addClass('btn-primary');
						break;
					case 'econnrefused':
						displayText = 'Connect';
						$('#divProPresenterStatus').text('Connection Refused. Is ProPresenter running and configured for network access?');
						$('#btnProPresenterConnect').removeClass('btn-primary btn-warning btn-danger');
						$('#btnProPresenterConnect').addClass('btn-primary');
						propresenter_disablefields(false);
						break;
					case 'etimedout':
						displayText = 'Connect';
						$('#divProPresenterStatus').text('Connection Timed Out. Is ProPresenter running and configured for network access?');
						$('#btnProPresenterConnect').removeClass('btn-primary btn-warning btn-danger');
						$('#btnProPresenterConnect').addClass('btn-primary');
						propresenter_disablefields(false);
						break;
					default:
						displayText = propresenter_status;
						break;
				}
				$('#btnProPresenterConnect').text(displayText);
			});

			ipc.on('mdns_propresenter_hosts', function(event, hosts) {
				mdns_propresenter_hosts = hosts;
				let htmlAppend = '';

				for (let i = 0; i < mdns_propresenter_hosts.length; i++) {
					htmlAppend += '<a class="badge badge-pill badge-info" href="#" onclick="propresenter_usemdns(\'' + mdns_propresenter_hosts[i].ip + '\',\'' + mdns_propresenter_hosts[i].port + '\');">' + mdns_propresenter_hosts[i].name + ' (' + mdns_propresenter_hosts[i].ip + ')</a>';					
				}
				$('#divProPresenterHosts').html(htmlAppend);
			});

			ipc.on('mdns_midirelay_hosts', function(event, hosts) {
				mdns_midirelay_hosts = hosts;
				let htmlAppend = '';

				console.log(mdns_midirelay_hosts);
				for (let i = 0; i < mdns_midirelay_hosts.length; i++) {
					htmlAppend += '<a class="badge badge-pill badge-info" href="#" onclick="midirelay_usemdns(\'' + mdns_midirelay_hosts[i].ip + '\',\'' + mdns_midirelay_hosts[i].port + '\');">' + mdns_midirelay_hosts[i].ip + ' (' + mdns_midirelay_hosts[i].port + ')</a>';					
				}
				$('#divMidiRelayHosts').html(htmlAppend);
			});

			ipc.on('presentationbridge_status', function (event, status) {
				let displayText = '';
				presentationbridge_status = status;
				switch(presentationbridge_status) {
					case 'disconnected':
						displayText = 'Connect';
						$('#divPPresentationBridgeStatus').text('Disconnected.');
						$('#btnPresentationBridgeConnect').removeClass('btn-primary btn-warning btn-danger');
						$('#btnPresentationBridgeConnect').addClass('btn-primary');
						presentationbridge_disablefields(false);
						break;
					case 'connecting':
						displayText = 'Connecting...';
						presentationbridge_disablefields(true);
						$('#btnPresentationBridgeConnect').removeClass('btn-primary btn-warning btn-danger');
						$('#btnPresentationBridgeConnect').addClass('btn-warning');
						break;
					case 'connected':
						displayText = 'Authenticating...';
						presentationbridge_disablefields(true);
						$('#btnPresentationBridgeConnect').removeClass('btn-primary btn-warning btn-danger');
						$('#btnPresentationBridgeConnect').addClass('btn-warning');
						break;
					case 'authenticated':
						displayText = 'Disconnect';
						presentationbridge_disablefields(true);
						$('#btnPresentationBridgeConnect').removeClass('btn-primary btn-warning btn-danger');
						$('#btnPresentationBridgeConnect').addClass('btn-danger');
						break;
					case 'badid':
						displayText = 'Connect';
						presentationbridge_disablefields(false);
						$('#divPresentationBridgeStatus').text('Invalid Bridge ID.');
						$('#btnPresentationBridgeConnect').removeClass('btn-primary btn-warning btn-danger');
						$('#btnPresentationBridgeConnect').addClass('btn-primary');
						break;
					case 'badpassword':
						displayText = 'Connect';
						presentationbridge_disablefields(false);
						$('#divPresentationBridgeStatus').text('Incorrect Bridge ID or Password.');
						$('#btnPresentationBridgeConnect').removeClass('btn-primary btn-warning btn-danger');
						$('#btnPresentationBridgeConnect').addClass('btn-primary');
						break;
					case 'inuse':
						displayText = 'Connect';
						presentationbridge_disablefields(false);
						$('#divPresentationBridgeStatus').text('This Bridge is already in use elsewhere.');
						$('#btnPresentationBridgeConnect').removeClass('btn-primary btn-warning btn-danger');
						$('#btnPresentationBridgeConnect').addClass('btn-primary');
						break;
					case 'econnrefused':
						displayText = 'Connect';
						presentationbridge_disablefields(false);
						$('#divPresentationBridgeStatus').text('Connection Refused. Is Presentation Bridge running on the server?');
						$('#btnPresentationBridgeConnect').removeClass('btn-primary btn-warning btn-danger');
						$('#btnPresentationBridgeConnect').addClass('btn-primary');
						break;
					case 'etimedout':
						displayText = 'Connect';
						presentationbridge_disablefields(false);
						$('#divPresentationBridgeStatus').text('Connection Timed Out. Is Presentation Bridge running on the server?');
						$('#btnPresentationBridgeConnect').removeClass('btn-primary btn-warning btn-danger');
						$('#btnPresentationBridgeConnect').addClass('btn-primary');
						break;
					default:
						displayText = presentationbridge_status;
						break;
				}
				$('#btnPresentationBridgeConnect').text(displayText);
			});

			ipc.on('cs', function(event, cs) {
				$('#divCurrentSlide').html(cs.replace(/\n/g, '<br />'));
			});

			ipc.on('csn', function(event, csn) {
				processSlideNotes('csn', csn);
			});

			ipc.on('ns', function(event, ns) {
				$('#divNextSlide').html(ns.replace(/\n/g, '<br />'));
			});

			ipc.on('nsn', function(event, nsn) {
				processSlideNotes('nsn', nsn);
			});

			$( document ).ready(function() {
				$('#txtProPresenterIP').val(config.get('propresenterIP'));
				$('#txtProPresenterPort').val(config.get('propresenterPort'));
				$('#txtProPresenterPassword').val(config.get('propresenterPassword'));

				$('#txtPresentationBridgeHost').val(config.get('presentationbridgeHost'));
				$('#txtPresentationBridgePort').val(config.get('presentationbridgePort'));
				$('#txtPresentationBridgeID').val(config.get('presentationbridgeID'));
				$('#txtPresentationBridgePassword').val(config.get('presentationbridgePassword'));

				$('#switchMidiRelay').prop('checked', config.get('plugin_midirelay'));
				$('#txtMIDIRelayIP').val(config.get('midirelayIP'));
				$('#txtMIDIRelayPort').val(config.get('midirelayPort'));
				$('#txtMIDIRelayMIDIPort').val(config.get('midirelayMIDIPort'));

				$('#switchVista').prop('checked', config.get('plugin_vista'));
				$('#txtVistaIP').val(config.get('vistaIP'));
				$('#txtVistaPort').val(config.get('vistaPort'));
				$('#txtVistaMIDIPort').val(config.get('vistaMIDIPort'));

				$('#switchHttp').prop('checked', config.get('plugin_http'));

				$('#switchCompanion').prop('checked', config.get('plugin_companion'));
				$('#txtCompanionIP').val(config.get('companionIP'));

				ipc.send('propresenter_status');
				ipc.send('mdns_propresenter_hosts');
				ipc.send('mdns_midirelay_hosts');

				$("body").tooltip({ selector: '[data-toggle=tooltip]' });

				fs.readFile(helpFile, 'utf8' , (err, data) => {
					if (err) {
						console.error(err);
						return;
					}
					$('#divHelpBody').html(marked(data));
				});

				$('[ip-mask]').ipAddress();
			});

			function propresenter_connect() {
				let propresenterIP = $('#txtProPresenterIP').val();
				let propresenterPort = $('#txtProPresenterPort').val();
				let propresenterPassword = $('#txtProPresenterPassword').val();

				ipc.send('propresenter_disconnect');

				if ((propresenter_status === 'authenticated') || (propresenter_status === 'connecting')) {
					$('#btnProPresenterConnect').text('Disconnecting...');
					$('#btnProPresenterConnect').removeClass("btn-primary").addClass("btn-warning");
					//ipc.send('propresenter_disconnect');
				}
				else {
					$('#btnProPresenterConnect').text('Connecting...');
					$('#btnProPresenterConnect').removeClass("btn-primary").addClass("btn-warning");
					config.set('propresenterIP', propresenterIP);
					config.set('propresenterPort', propresenterPort);
					config.set('propresenterPassword', propresenterPassword);
					ipc.send('propresenter_connect');
				}
			}

			function presentationbridge_connect() {
				let presentationbridgeHost = $('#txtPresentationBridgeHost').val();
				let presentationbridgePort = $('#txtPresentationBridgePort').val();
				let presentationbridgeID = $('#txtPresentationBridgeID').val();
				let presentationbridgePassword = $('#txtPresentationBridgePassword').val();

				if (presentationbridge_status === 'authenticated') {
					ipc.send('presentationbridge_disconnect');
				}
				else {
					config.set('presentationbridgeHost', presentationbridgeHost);
					config.set('presentationbridgePort', presentationbridgePort);
					config.set('presentationbridgeID', presentationbridgeID);
					config.set('presentationbridgePassword', presentationbridgePassword);
					ipc.send('presentationbridge_connect');
				}
			}

			function propresenter_disconnect() {
				ipc.send('propresenter_disconnect');
			}

			function propresenter_disablefields(value) {
				$('#txtProPresenterIP').prop('disabled', value);
				$('#txtProPresenterPort').prop('disabled', value);
				$('#txtProPresenterPassword').prop('disabled', value);
			}

			function propresenter_usemdns(ip, port) {
				propresenter_disconnect();
				$('#txtProPresenterIP').val(ip);
				$('#txtProPresenterPort').val(port);
			}

			function midirelay_usemdns(ip, port) {
				$('#txtMIDIRelayIP').val(ip);
				$('#txtMIDIRelayPort').val(port);
			}

			function presentationbridge_disablefields(value) {
				$('#txtPresentationBridgeHost').prop('disabled', value);
				$('#txtPresentationBridgePort').prop('disabled', value);
				$('#txtPresentationBridgeID').prop('disabled', value);
				$('#txtPresentationBridgePassword').prop('disabled', value);
			}

			function plugin_enable(plugin) {
				let enable = '';

				switch(plugin) {
					case 'midirelay':
						enable = $('#switchMidiRelay').prop('checked');
						break;
					case 'vista':
						enable = $('#switchVista').prop('checked');
						break;
					case 'http':
						enable = $('#switchHttp').prop('checked');
						break;
					case 'companion':
						enable = $('#switchCompanion').prop('checked');
						break;
					default:
						break;
				}

				config.set('plugin_' + plugin, enable);
			}

			function save() {
				config.set('midirelayIP', $('#txtMIDIRelayIP').val());
				config.set('midirelayPort', $('#txtMIDIRelayPort').val());
				config.set('midirelayMIDIPort', $('#txtMIDIRelayMIDIPort').val());

				config.set('vistaIP', $('#txtVistaIP').val());
				config.set('vistaPort', $('#txtVistaPort').val());
				config.set('vistaMIDIPort', $('#txtVistaMIDIPort').val());

				config.set('companionIP', $('#txtCompanionIP').val());
			}

			function processSlideNotes(type, text) {
				switch(type) {
					case 'csn':
						$('#divCurrentSlideNotes').html('');
						break;
					case 'nsn':
						$('#divNextSlideNotes').html('');
						break;
				}

				if (text !== '') {
					if (text.indexOf(':') > -1) {
						let commands = text.split(';');
						for (let i = 0; i < commands.length; i++) {
							let command = commands[i].substring(0, commands[i].indexOf(':')).toLowerCase();
							let parameters = commands[i].substring(commands[i].indexOf(':')+1).split(',');					
							let commandObj = {};
					
							if (parameters) {
								switch(command) {
									case 'noteon':
										//"noteon:0,55,100" Note On Command, Channel 1 (zero based), Note 55, Velocity 100
										commandObj.midiport = config.get('midirelayMIDIPort');
										commandObj.midicommand = 'noteon';
										commandObj.channel = parameters[0];
										commandObj.note = parameters[1];
										commandObj.velocity = parameters[2];
										buildPill(command, commandObj, type);
										break;
									case 'noteoff':
										//"noteoff:0,55,0" Note Off Command, Channel 1 (zero based), Note 55, Velocity 0
										commandObj.midiport = config.get('midirelayMIDIPort');
										commandObj.midicommand = 'noteoff';
										commandObj.channel = parameters[0];
										commandObj.note = parameters[1];
										commandObj.velocity = parameters[2];
										buildPill(command, commandObj, type);
										break;
									case 'aftertouch':
										//"aftertouch:0,55,100" Polyphonic Aftertouch Command, Channel 1 (zero based), Note 55, Value 100
										commandObj.midiport = config.get('midirelayMIDIPort');
										commandObj.midicommand = 'aftertouch';
										commandObj.channel = parameters[0];
										commandObj.note = parameters[1];
										commandObj.value = parameters[2];
										buildPill(command, commandObj, type);
										break;
									case 'cc':
										//"cc:0,32,100" CC (Controller Change) Command, Channel 1 (zero based), Controller 32, Value 100
										commandObj.midiport = config.get('midirelayMIDIPort');
										commandObj.midicommand = 'cc';
										commandObj.channel = parameters[0];
										commandObj.note = parameters[1];
										commandObj.value = parameters[2];
										buildPill(command, commandObj, type);
										break;
									case 'pc':
										//"pc:0,100" PC (Program Change) Command, Channel 1 (zero based), Value 100
										commandObj.midiport = config.get('midirelayMIDIPort');
										commandObj.midicommand = 'pc';
										commandObj.channel = parameters[0];
										commandObj.value = parameters[1];
										buildPill(command, commandObj, type);
										break;
									case 'pressure':
										//"pressure:0,100" Channel Pressure / Aftertouch Command, Channel 1 (zero based), Value 100
										commandObj.midiport = config.get('midirelayMIDIPort');
										commandObj.midicommand = 'pressure';
										commandObj.channel = parameters[0];
										commandObj.value = parameters[1];
										buildPill(command, commandObj, type);
										break;
									case 'pitchbend':
										//"pitchbend:0,100" Pitchbend Command, Channel 1 (zero based), Value 100
										commandObj.midiport = config.get('midirelayMIDIPort');
										commandObj.midicommand = 'pitchbend';
										commandObj.channel = parameters[0];
										commandObj.value = parameters[1];
										buildPill(command, commandObj, type);
										break;
									case 'msc':
										//"msc:0,lighting.general,go,1,12,," MSC Command, Device ID 0, Command Format lighting.general, Cue 1, Cuelist 12, Cue Path blank
										commandObj.midiport = config.get('midirelayMIDIPort');
										commandObj.midicommand = 'msc';
										commandObj.deviceid = parameters[0];
										commandObj.commandformat = parameters[1];
										commandObj.command = parameters[2];
										commandObj.cue = parameters[3];
										commandObj.cuelist = parameters[4];
										commandObj.cuepath = parameters[5];
										buildPill(command, commandObj, type);
										break;
									case 'sysex':
										//"sysex;0xF0,0x41,0x10,0x00,0x00,0x00,0x20,0x12,0x71,0x00,0x08,0x00,0x07,0xF7" SysEx Command, Hexadecimal or Decimal format
										commandObj.midiport = config.get('midirelayMIDIPort');
										commandObj.midicommand = 'sysex';
										commandObj.message = parameters[0];
										buildPill(command, commandObj, type);
										break;
									case 'vista':
										//"vista:12,1" Vista MSC Command, Cuelist 12, Cue 1
										commandObj.midiport = config.get('vistaMIDIPort');
										commandObj.midicommand = 'msc';
										commandObj.deviceid = '0';
										commandObj.commandformat = 'lighting.general';
										commandObj.command = 'go';
										commandObj.cue = parameters[1];
										commandObj.cuelist = parameters[0];
										commandObj.cuepath = '';
										buildPill(command, commandObj, type);
										break;
									case 'http':
										//"http:post,url,{json}"
										//"http:get,url"
										//"http:url"
										if (parameters[0] === 'POST') {
											commandObj.type = 'POST';
											commandObj.url = parameters[1];
											if (parameters[2]) {
												commandObj.data = parameters[2];
											}
										}
										else if (parameters[0] === 'GET') {
											commandObj.type = 'GET';
											commandObj.url = parameters[1];
										}
										else {
											commandObj.type = 'GET';
											commandObj.url = parameters[0];
										}
										buildPill(command, commandObj, type);
										break;
									case 'companion':
										//"companion:1,2"
										commandObj.bank = parameters[0];
										commandObj.button = parameters[1];
										buildPill(command, commandObj, type);
										break;
									default:
										commandObj.text = 'Invalid Command';
										buildPill(command, commandObj, type);
										break;
								}
							}
						}
					}
				}
			}

			function buildPill(command, obj, type) {
				let htmlAppend = '';
				let tooltipData = '';
				let name = '';

				switch(command) {
					case 'noteon':
						tooltipData = 'Channel ' + obj.channel + ', Note ' + obj.note + ', Velocity ' + obj.velocity;
						name = 'Note On';
						break;
					case 'noteoff':
						tooltipData = 'Channel ' + obj.channel + ', Note ' + obj.note + ', Velocity ' + obj.velocity;
						name = 'Note Off';
						break;
					case 'aftertouch':
						tooltipData = 'Channel ' + obj.channel + ', Note ' + obj.note + ', Value ' + obj.value;
						name = 'Polyphonic Aftertouch';
						break;
					case 'cc':
						tooltipData = 'Channel ' + obj.channel + ', Note ' + obj.note + ', Value ' + obj.value;
						name = 'Controller Change';
						break;
					case 'pc':
						tooltipData = 'Channel ' + obj.channel + ', Value ' + obj.value;
						name = 'Program Change';
						break;
					case 'pressure':
						tooltipData = 'Channel ' + obj.channel + ', Value ' + obj.value;
						name = 'Channel Pressure';
						break;
					case 'pitchbend':
						tooltipData = 'Channel ' + obj.channel + ', Value ' + obj.value;
						name = 'Pitchbend';
						break;
					case 'msc':
						tooltipData = 'Device ID ' + obj.deviceid + ', Command Format ' + obj.commandformat + ', Command ' + obj.command + ', Cue ' + obj.cue + ', Cuelist ' + obj.cuelist + ', Cuepath ' + obj.cuepath;
						name = 'MIDI Show Control';
						break;
					case 'sysex':
						tooltipData = 'Message ' + obj.message;
						name = 'SysEx';
					case 'vista':
						tooltipData = 'Cuelist ' + obj.cuelist + ', Cue ' + obj.cue;
						name = 'Vista';
						break;
					case 'http':
						tooltipData = 'Type ' + obj.type + ', URL ' + obj.url;
						name = 'HTTP';
						break;
					case 'companion':
						tooltipData = 'Bank ' + obj.bank + ', Button ' + obj.button;
						name = 'Companion Button';
						break;
					default:
						break;
				}

				htmlAppend = '<span class="badge badge-pill badge-primary" data-toggle="tooltip" data-placement="bottom" title="' + tooltipData + '">' + name + '</span>';

				switch(type) {
					case 'csn':
						$('#divCurrentSlideNotes').append(htmlAppend);
						break;
					case 'nsn':
						$('#divNextSlideNotes').append(htmlAppend);
						break;
				}
			}

			function openAuthor() {
				shell.openExternal('http://techministry.blog');
			}
		</script>
	</head>
	<body>
		<div class="container">
			<header>
				<h1>PresentationBridge Client</h1>
				<h2>Created by <a href="#" onclick="openAuthor();">techministry.blog</a></h2>
				<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#helpModal">
					Help
				  </button>
			</header>
			<div class='row'>
				<div class='col-sm'>
					<section>
						<div class='row'>ProPresenter Settings:</div>
						<div class='form-row'>
							<div class='form-group col-md-11' id='divProPresenterHosts'>

							</div>
						</div>
						<div id='divProPresenterStatus'></div>
						<div class='form-row'>
							<div class='form-group col-md-6'>
								<div class="input-group">
									<div class="input-group-prepend">
										<label class="input-group-text" for="txtProPresenterIP">IP</label>
									</div>
									<input type="text"  id='txtProPresenterIP' class='form-control' minlength="7" maxlength="15" ip-mask value="127.0.0.1" placeholder="000.000.000.000">
								</div>
							</div>
						</div>
						<div class='form-row'>
							<div class='form-group col-md-11'>
								<div class="input-group">
									<div class="input-group-prepend">
										<label class="input-group-text" for="txtProPresenterPort">Stage Display Port</label>
									</div>	
									<input type='number' id='txtProPresenterPort' class='form-control'/>
								</div>
							</div>
						</div>
						<div class='form-row'>
							<div class='form-group col-md-11'>
								<div class="input-group">
									<div class="input-group-prepend">
										<label class="input-group-text" for="txtProPresenterPassword">Stage Display Password</label>
									</div>
									<input type='password' id='txtProPresenterPassword' class='form-control' />
								</div>
							</div>
						</div>
						<div class='form-row'>
							<div class='form-group col-md-11'>
								<button class='btn btn-primary' id='btnProPresenterConnect' onclick='propresenter_connect();'>Connect to ProPresenter</button>
							</div>
						</div>
					</section>
					<section>
						<div class='row'>Presentation Bridge:</div>
						<div id='divPresentationBridgeStatus'></div>
						<div class='form-row'>
							<div class='form-group col-md-6'>
								<div class="input-group">
									<div class="input-group-prepend">
										<label class="input-group-text" for="txtPresentationBridgeHost">Bridge Host</label>
									</div>
									<input type="text"  id='txtPresentationBridgeHost' class='form-control' minlength="7" maxlength="15" ip-mask value="192.168.1.1" placeholder="000.000.000.000">
								</div>
							</div>
							<div class='form-group col-md-5'>
								<div class="input-group">
									<div class="input-group-prepend">
										<label class="input-group-text" for="txtPresentationBridgePort">Bridge Port</label>
									</div>	
									<input type='number' id='txtPresentationBridgePort' class='form-control'/>
								</div>
							</div>
						</div>
						<div class='form-row'>
							<div class='form-group col-md-11'>
								<div class="input-group">
									<div class="input-group-prepend">
										<label class="input-group-text" for="txtPresentationBridgeID">Bridge ID</label>
									</div>
									<input type='text' id='txtPresentationBridgeID' class='form-control' />
								</div>
							</div>
						</div>
						<div class='form-row'>
							<div class='form-group col-md-11'>
								<div class="input-group">
									<div class="input-group-prepend">
										<label class="input-group-text" for="txtPresentationBridgePassword">Bridge Password</label>
									</div>
									<input type='password' id='txtPresentationBridgePassword' class='form-control' />
								</div>
							</div>
						</div>
						<div class='form-row'>
							<div class='form-group col-md-11'>
								<button class='btn btn-primary' id='btnPresentationBridgeConnect' onclick='presentationbridge_connect();'>Connect to Presentation Bridge</button>
							</div>
						</div>
					</section>
					<section>
						<div class='row'>
							<div class="custom-control custom-switch">
								<input type="checkbox" class="custom-control-input" id="switchMidiRelay" onClick="plugin_enable('midirelay');">
								<label class="custom-control-label" for="switchMidiRelay">midi-relay</label>
							  </div>
						</div>
						<div class='form-row'>
							<div class='form-group col-md-11' id='divMidiRelayHosts'>

							</div>
						</div>
						<div class='form-row'>
							<div class='form-group col-md-6'>
								<div class="input-group">
									<div class="input-group-prepend">
										<label class="input-group-text" for="txtMIDIRelayIP">IP</label>
									</div>
									<input type="text"  id='txtMIDIRelayIP' class='form-control' minlength="7" maxlength="15" ip-mask value="127.0.0.1" placeholder="000.000.000.000">
								</div>
							</div>
							<div class='form-group col-md-5'>
								<div class="input-group">
									<div class="input-group-prepend">
										<label class="input-group-text" for="txtMIDIRelayPort">Port</label>
									</div>	
									<input type='number' id='txtMIDIRelayPort' class='form-control'/>
								</div>
							</div>
						</div>
						<div class='form-row'>
							<div class='form-group col-md-11'>
								<div class="input-group">
									<div class="input-group-prepend">
										<label class="input-group-text" for="txtMIDIRelayMIDIPort">MIDI Port</label>
									</div>	
									<input type='text' id='txtMIDIRelayMIDIPort' class='form-control'/>
								</div>
							</div>
						</div>
					</section>
					<section>
						<div class='row'>
							<div class="custom-control custom-switch">
								<input type="checkbox" class="custom-control-input" id="switchVista" onClick="plugin_enable('vista');">
								<label class="custom-control-label" for="switchVista">Chroma-Q Vista (using midi-relay)</label>
							  </div>
						</div>
						<div class='form-row'>
							<div class='form-group col-md-6'>
								<div class="input-group">
									<div class="input-group-prepend">
										<label class="input-group-text" for="txtVistaIP">IP</label>
									</div>
									<input type="text"  id='txtVistaIP' class='form-control' minlength="7" maxlength="15" ip-mask value="127.0.0.1" placeholder="000.000.000.000">
								</div>
							</div>
							<div class='form-group col-md-5'>
								<div class="input-group">
									<div class="input-group-prepend">
										<label class="input-group-text" for="txtVistaPort">Port</label>
									</div>	
									<input type='number' id='txtVistaPort' class='form-control'/>
								</div>
							</div>
						</div>
						<div class='form-row'>
							<div class='form-group col-md-11'>
								<div class="input-group">
									<div class="input-group-prepend">
										<label class="input-group-text" for="txtVistaMIDIPort">MIDI Port</label>
									</div>	
									<input type='text' id='txtVistaMIDIPort' class='form-control'/>
								</div>
							</div>
						</div>
					</section>
					<section>
						<div class='row'>
							<div class="custom-control custom-switch">
								<input type="checkbox" class="custom-control-input" id="switchHttp" onClick="plugin_enable('http');">
								<label class="custom-control-label" for="switchHttp">HTTP Requests</label>
							  </div>
						</div>
					</section>
					<section>
						<div class='row'>
							<div class="custom-control custom-switch">
								<input type="checkbox" class="custom-control-input" id="switchCompanion" onClick="plugin_enable('companion');">
								<label class="custom-control-label" for="switchCompanion">Companion Button Press</label>
							  </div>
						</div>
						<div class='row'>
							<div class='form-group col-md-11'>
								<div class="input-group">
									<div class="input-group-prepend">
										<label class="input-group-text" for="txtCompanionIP">Companion IP</label>
									</div>
									<input type="text"  id='txtCompanionIP' class='form-control' minlength="7" maxlength="15" pattern="^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$">
								</div>
							</div>
						</div>
					</section>
					<section>
						<div class='form-row'>
							<div class='form-group col-md-11'>
								<button class='btn btn-primary' id='btnSave' onclick='save();'>Save Settings</button>
							</div>
						</div>
					</section>
				</div>
				<div class='col-sm'>
					<div class='row'><b>Current Slide:</b></div>
					<div class='row' style='height: 150px;border: #eeeeee 1px solid;' id='divCurrentSlide'></div>
					<div class='row' id='divCurrentSlideNotes'></div>
					<div class='row'>&nbsp;</div>
					<div class='row'><b>Next Slide:</b></div>
					<div class='row' style='height: 150px;border: #eeeeee 1px solid;' id='divNextSlide'><b>Next Slide:</b></div>
					<div class='row' id='divNextSlideNotes'></div>
				</div>
			</div>
			<div class="modal fade" id="helpModal" tabindex="-1" role="dialog" aria-labelledby="helpModalLabel" aria-hidden="true">
				<div class="modal-dialog" role="document">
				  <div class="modal-content">
					<div class="modal-header">
					  <h5 class="modal-title" id="helpModalLabel">Help</h5>
					  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					  </button>
					</div>
					<div class="modal-body" id='divHelpBody'>
					  
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
					  </div>
				  </div>
				</div>
			  </div>
			<footer></footer>
		</div>
	</body>
</html>
